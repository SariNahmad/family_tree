<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <script type="text/javascript" src="//d3js.org/d3.v3.js"></script>
  <style type="text/css">
    body {
    font: 10px sans-serif;
    }

  </style>

  <title>Family Tree</title>
  

<script type='text/javascript'>//<![CDATA[
window.onload=function(){

// loads in the json names treeData
var root;
d3.json("./json_data/example_json.json", function(error, treeData) {
   if (error) throw error;
//function
   draw_tree(treeData);
});


function draw_person(svgSelection, xx, yy, person){
  var txt = svgSelection.append("text")
     .attr("x",xx)
     .attr("y",yy)
     .attr("text-anchor","middle")
     .text(person.id);
  var bbox = txt.node().getBBox();
  var rect = svgSelection.append("rect")
    .attr("x", bbox.x-bbox.width*0.25)
    .attr("y", bbox.y-bbox.height*0.25)
    .attr("width", bbox.width*1.5)
    .attr("height", bbox.height*1.5)
    .attr("id", person.id)
    .style("fill", "orange")
    .style("fill-opacity", "0.3")
    .style("stroke", "#666")
    .style("stroke-width", "1.0px");  
}

function connect_two_people(svgSelection, person1, person2){
   x1 = d3.select("#" + person1.id).attr("x");
   y1 = d3.select("#" + person1.id).attr("y");
   x2 = d3.select("#" + person2.id).attr("x");
   y2 = d3.select("#" + person2.id).attr("y");

   var connector = svgSelection.append("line")
                               .attr("x1",x1)
                               .attr("y1",y1)
                               .attr("x2",x2)
                               .attr("y2",y2)
                               .attr("stroke-width", 2)
                               .attr("stroke", "black");
}

function draw_tree(tree){
//   alert(tree.length);
   var bodySelection = d3.select("body");
   var svgSelection = bodySelection.append("svg")//vector graphic thing
                                   .attr("width", 2000)
                                   .attr("height", 1000);

   //Draw people boxes :)
   for (i = 0; i < tree.length; i++){
     gennum = tree[i].generation_number;
     xx = 100;
     if (gennum >= 0){
       yy = 100+30*gennum
     }
     if (gennum < 0){
       yy = 500
     }
     //calls draw person 
     draw_person(svgSelection, xx+80*(i % 10), yy, tree[i]);
   }

   //Connect people
   connect_two_people(svgSelection, tree[0],tree[1]);  
}



}//]]> 

</Script>

<body>
</body>

</html>

